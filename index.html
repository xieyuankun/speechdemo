<html>

<article>
  <header>
	<h1>Prosody learning from quantized vector in End-to-End Speech Synthesis</h1>
  </header>
</article>

<p><b>Authors:</b> Yutian Wang1, Yuankun Xie1, Huaichang Du2, Hui Wang3*, Qin Zhang3 </p>

<div><b>Abstract:</b> In recent years, deep learning has achieved great success in the field of text-to-speech(TTS) . However, there are still some limitations on the TTS models. First, the amount of the parameters of TTS model is very large which make the model hard to train and cannot be used in real-time scene, second, generating rhythmic speech is still a difficult task. In this paper, we describe a novel TTS architecture which can simulate the speaking prosody from reference audio and control the prosody from the latent quantized vector. Our system consists of three components: (1)Prosody encoder based on Vector Quantized Variational AutoEncoder(VQ-VAE) to learn the latent rep-resentation from reference audio. (2)a se-quence-to-sequence synthesis network based on Tacotron that generates mel spectrogram of input text which is conditioned on the latent code from prosody encoder. (3)a vocoder named WaveRNN, which can get the final audio from mel spectro-gram.  Experiments shown that the quality of generative results is competitive to state of the art and have same rhythmic details of the reference speeches. 
</div>


 

<head>
<meta charset="UTF-8">
<title>Demo page</title>
</head>



<h2>Style transfer</h2></a>
<h3>1. Parallel transfer</h3></a>
   <p class="sample">
    1." It was very hard that she was not to have her own knife . "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/CA-MP3-07-172.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
     2." No , Mister Clay , but theres a fellow in your brick-yard flogging two horses to death.  "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/CA-BB-20-27.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/gst/3000000p.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
     3." It must be sitting up so late last night .    "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/CA-MP2-11-022.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
    4." But you are quite right ; you could not have chosen better      ."
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/CA-MP2-12-050.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
    
	5." I tell you what , Ned , I'm afraid it hasn't been all right with Reuben      .   "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/CA-BB-26-26.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/gst/3000000.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
    6." Oh dear , no , ma'am , nobody suspected you         !      .   "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP1-13-082/CA-MP1-13-082.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP1-13-082/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP1-13-082/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP1-13-082/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
     7." I think I will have two shawls , Fanny .          "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-13-121/CA-MP2-13-121.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-13-121/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-13-121/sound0.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-13-121/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
  </p>   
 8." 莽莽乡野，万水千山，铿锵承诺。          "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/000343.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/1/output/logs-eval/wavs/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/1/style transfer.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/1/GST.wav" controls></audio></td>
    </tr>
    </table>
    </blockquote>
  </p>     
  
<h3>2. Non-parallel transfer</h3></a>
   <p class="sample">
   	<div>1. reference text : " This very morning I had to go a clear six miles and only took three shillings . "</div>
   	<div > generated text: " Though they could not force him to gamble and he was compelled to drink . "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Parallel transfer</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/CA-BB-39-18.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/sound0.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/sound1.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   

	<div>2. reference text : " It must be sitting up so late last night . "</div>
   	<div > generated text: " The provision of more baths was also suggested . "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Parallel transfer</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/CA-MP2-11-022.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/sound0.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/sound1.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/gst/__mel-batch_0_sentence_1__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   
    
    <div>3. reference text : " The man that had the care of us never gave me a kind word in my life         .  "</div>
   	<div > generated text: " On the whole the type of this book may be considered the ultra of Gothic type     .   "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Parallel transfer</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-07-10/CA-BB-07-10.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-07-10/sound0.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-07-10/sound1.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-07-10/gst/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   
    
    <div>4. reference text : " No , Mister Clay , but theres a fellow in your brick-yard flogging two horses to death       .   "</div>
   	<div > generated text: " one, for seven years , that of a man sentenced to death for whom great interest to made    .  "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Parallel transfer</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/CA-BB-20-27.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/sound0.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/sound1.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/gst/3000000.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   
	

<h3>3. Non-punctuation transfer</h3></a>   
 <p class="sample">
   	<div>1. reference text : " 只愿苍天相照应留得情谊比锦翠"</div>
   	<div > generated text: "入则恳恳以尽忠出则谦谦以自悔 "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000142/000142.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000142/__mel-batch_0_sentence_0__1131k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000142/GST.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   
    <div>2. reference text : " 十年沧海劈波斩浪"</div>
   	<div > generated text: "老骥伏枥志在千里 "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/2/000364.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/2/__mel-batch_0_sentence_0__1131k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000343/2/GST.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   


   	<div>3. reference text : " 卯兔开新岁两岸共迎春"</div>
   	<div > generated text: "扪萝登塔远刳木取泉遥 "</div>	
    <blockquote>
    <table>
    <tr>
     <td align=center width=300>reference audio</td><td align=center width=300>Non-parallel transfer</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000106/000106.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000106/__mel-batch_0_sentence_0__1131k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/000106/GST.wav" controls></audio></td>
    </tr>
    </table>	














 
<body>
<h2>Style control</h2></a>
<h3>1. pitch high</h3></a>

	" This very morning I had to go a clear six miles and only took three shillings .
 "
    <blockquote>
    <table>
    <tr>
    <td align=center width=120>dimension 2×-4</td><td align=center width=300>normal</td><td align=center width=300>dimension 2×4</td> 
    </tr>
    <tr>
	<tr><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/-4/pitch high.wav" controls></audio></td><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/CA-BB-39-18.wav" controls></audio></td><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/4/pitch high.wav" controls></audio></td></tr>
	
    </tr>
    </table>	
    </blockquote>  
<h3>2. speaking rate</h3></a>
	" This very morning I had to go a clear six miles and only took three shillings .
 "
    <blockquote>
    <table>
    <tr>
    <td align=center width=120>dimension 15×-4</td><td align=center width=300>normal</td><td align=center width=300>dimension 15×4</td> 
    </tr>
    <tr>
	<tr><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/-4/speed.wav" controls></audio></td><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/CA-BB-39-18.wav" controls></audio></td><td><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-39-18/4/speed.wav" controls></audio></td></tr>
	
    </tr>
    </table>	
    </blockquote>  
  </p>    
  
 </body>
</html>