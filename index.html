<html>

<article>
  <header>
	<h1>Efficient Style Transfer and control in End-to-End Speech Synthesis</h1>
  </header>
</article>

<p><b>Authors:</b> Yutian Wang, Yuankun Xie </p>

<div><b>Abstract:</b> In recent years, deep learning has shown impressive works in the field of text-to-speech(TTS) and the most representative TTS system is Tacotron. However, the training speed of Tactoron is too slow and the speakerâ€™s speaking style is difficult to generate. In this paper, we describe an efficient TTS system, which can quickly learn the speaking styles from reference audio and converts text into speech in real time. Our system consists of three trained components: (1)Vector Quantised Variational AutoEncoder(VQ-VAE), trained on a style transfer task using an unsupervised method, to learn the latent representation from reference audio. VQ-VAE has discrete latent variables with a new way of training, which can training faster than Variational AutoEncoder(VAE); (2)a sequence-to-sequence synthesis network based on Tacotron that generates a mel spectrogram of text conditioned on latent embedding from VQ-VAE ;(3)a vocoder named WaveRNN, which can get the final audio from mel spectrogram. 
</div>



<p><b>Paper link </b> </p>
 

<head>
<meta charset="UTF-8">
<title>Demo page</title>
</head>



<h2>Style transfer</h2></a>
<h3>1. Parallel transfer</h3></a>
   <p class="sample">
    1." It was very hard that she was not to have her own knife . "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/CA-MP3-07-172.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP3-07-172/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="" controls></audio></td>
    </tr>
    </table>
    </blockquote>
     2." No , Mister Clay , but theres a fellow in your brick-yard flogging two horses to death.  "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/CA-BB-20-27.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-20-27/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="" controls></audio></td>
    </tr>
    </table>
    </blockquote>
     3." It must be sitting up so late last night .    "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/CA-MP2-11-022.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-11-022/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="" controls></audio></td>
    </tr>
    </table>
    </blockquote>
    4." But you are quite right ; you could not have chosen better      ."
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/CA-MP2-11-022.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-MP2-12-050/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="" controls></audio></td>
    </tr>
    </table>
    </blockquote>
    
	5." I tell you what , Ned , I'm afraid it hasn't been all right with Reuben      .   "
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>Griffin-Lim</td><td align=center width=300>WaveRNN</td><td align=center width=300>GST model</td>    
    </tr>
    <tr>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/CA-BB-26-26.wav" controls></audio></td>
    <td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/wav-batch_0_sentence_0-linear.wav" controls></audio></td>
	<td rowspan=2><audio src="https://raw.githubusercontent.com/xieyuankun/sample/master/CA-BB-26-26/__mel-batch_0_sentence_0__1046k_steps_gen_batched_target11000_overlap550.wav" controls></audio></td>
    <td rowspan=2><audio src="" controls></audio></td>
    </tr>
    </table>
    </blockquote>
  </p>   
<h3>1. Non-parallel transfer</h3></a>
   <p class="sample">
   	<div>1. <i>reference text</i> : " I love you . Good-by - because I love you . "</div>
   	<div > &ensp; <i>target text</i> : " She could not compose herself - Mr. Woodhouse would be alarmed - she had better go ; "</div>	
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/19.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/19.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/19.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>   

	<div>2. <i>reference text</i> : " Oh , what lovely trees ! "</div>
   	<div > &ensp; <i>target text</i> : said the Queen of the Corn-market , in an indifferently grateful tone .</div>	
	
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/27.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/27.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/27.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>	
		
	
	<div>3. <i>reference text</i> : " Find some one who is real wicked , and stay with him till he repents . In that way you can do some good in the world . "</div>
   	<div > &ensp; <i>target text</i> : He called again : the valleys and farthest hills resounded as when the sailors invoked the lost Hylas on the Mysian shore ; but no sheep .</div>			   
		
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/25.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/25.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/25.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>	

	<div>4. <i>reference text</i> : " Whenever you say the word I'm ready to thrash any amount of reason into him that he's able to hold . "</div>
   	<div > &ensp; <i>target text</i> : Oh , certainly not ; Lucy would stop with her cousin . Oh , no !</div>			   
		
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/03.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/03.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/03.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>		




	<div>5. <i>reference text</i> : " is the only place in Oz where a yellow butterfly can be found . "</div>
   	<div > &ensp; <i>target text</i> : His shoulders were broad and strong , his hands were very strong .</div>			   
		
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/40.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/40.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/40.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>

	<div>6. <i>reference text</i> : " Thy mother is yonder woman with the scarlet letter , "</div>
   	<div > &ensp; <i>target text</i> : Now it was finished - that is to say the design ; she must stitch it together .</div>	
 
    <blockquote>
    <table>
    <tr>
    <td align=center width=300>reference audio</td><td align=center width=300>GST baseline model</td><td align=center width=300>proposed model</td> 
    </tr>
    <tr>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/ref/59.wav" controls></audio></td>
    <td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/baseline/59.wav" controls></audio></td>
	<td rowspan=2><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_transfer/non-parallel/vae/59.wav" controls></audio></td>
    </tr>
    </table>	
    </blockquote>
    
<body>
<h2>Style control</h2></a>
<h3>1. Interpolation</h3></a>

    1." He had many years ago received such a description. "
    <blockquote>
    <table>
    <tr>
    <td align=center width=120> </td><td align=center width=300>reference audio</td><td align=center width=300>generated audio</td> 
    </tr>
    <tr>
	<tr><td>reference A</td><td><audio src="https://raw.githubusercontent.com/xieyuankun/speechsynthesis/master/CA-BB-07-10/123.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/interpolate/0_wavenet.wav" controls>
	</audio></td></tr>
	
	<tr><td>interpolated <b>z</b></td><td> </td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/interpolate/2_wavenet.wav" controls></audio></td></tr>
	
	<tr><td>interpolated <b>z</b></td><td> </td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/interpolate/4_wavenet.wav" controls></audio></td></tr>
	
	<tr><td>reference B</td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/interpolate/b1_3800040_0_style1.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/interpolate/7_wavenet.wav" controls></audio></td></tr>
	
    </tr>
    </table>	
    </blockquote>

<h3>2. Disentangled factors</h3></a>

	1." I suppose I may as well stay the night , "
	<blockquote>
    <table>
    <tr>
	<tr><td>pitch height</td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/pitch1_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/pitch2_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/pitch3_wavenet.wav" controls></audio></td></tr>

	<tr><td>local pitch variation</td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/flat1_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/flat2_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/disentangle/flat3_wavenet.wav" controls></audio></td></tr>	
    </tr>
    </table>
	</blockquote>


<h3>3. Combination</h3></a>

	1." I suppose I may as well stay the night , "
    <blockquote>
    <table>
    <tr>
    <td align=center width=120><b>z</b>=A</td><td align=center width=300><b>z</b>=B</td><td align=center width=300><b>z</b>=A+B</td> 
    </tr>
    <tr>
	<tr><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/combine/a_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/combine/b_wavenet.wav" controls></audio></td><td><audio src="http://home.ustc.edu.cn/~zyj008/ICASSP2019/audio/style_control/combine/com_wavenet.wav" controls></audio></td></tr>
	
    </tr>
    </table>	
    </blockquote>  

	
  </p>    
  
 </body>
</html>